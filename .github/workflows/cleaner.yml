name: VPN Cleaner (Genocide)

on:
  schedule:
    # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é: –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 04:00 UTC
    - cron: '0 */5 * * *' 
  workflow_dispatch: # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∫–Ω–æ–ø–∫—É

permissions:
  contents: write

jobs:
  cleaner:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        pip install aiohttp

    - name: Pull latest changes
      run: |
        git config --global user.name 'VPN Scout Bot'
        git config --global user.email 'bot@noreply.github.com'
        git pull origin main

    - name: Run Cleaner Logic
      run: |
        python cleaner.py

    - name: Commit and Push changes
      run: |
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º
        git add verified_ru.txt 2>/dev/null || true
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        if git diff --cached --quiet; then
          echo "No dead links found. Base is clean."
          exit 0
        fi
        
        # –ö–æ–º–º–∏—Ç–∏–º
        git commit -m "üßπ Cleaner: Genocide completed $(date +'%Y-%m-%d %H:%M:%S')"
        
        # –ü—É—à–∏–º
        git push origin main
